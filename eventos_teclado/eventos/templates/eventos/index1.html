<!DOCTYPE html>
<html lang="en">
<head>

	{% load static %}
	<meta charset="utf-8" />
	<title>JORDAN</title>
	<meta name="generator" content="Geany 1.29" />
        <link rel="stylesheet" href="{%  static 'eventos/estilos.css' %}" />
	<link rel="shortcut icon" href="{%  static 'eventos/favicon.ico' %}">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script type="text/javascript">
	// setup some JSON to use
	var cliente;

    var webcamSocket = new WebSocket(
        'ws://' + window.location.host +
        '/ws/eventos/video/');

    // var teclaSocket=new WebSocket(
    //     'ws://' + window.location.host +
    //     '/ws/eventos/tecla/');

    webcamSocket.onmessage = function(e) {
    	 var data=JSON.parse(e.data);
    	switch(data['type']) {
  			case 'imagen':
  				document.querySelector('#streaming').src= 'data:image/jpg;base64,'+data['message'];
    		break;
  			case 'clientes':
                console.log(data['message']);
                if(data['message']=='desc' ){
                    if(cliente>1){
                        cliente=cliente-1;
                    }
                }else{
                    cliente=data['message'];
                }
                console.log(cliente);

    		break;
  			default:
  			break;
}

        if(cliente==1){
                webcamSocket.send(JSON.stringify({
                    'message': '1',
                    'tipo':'imagen'
                }));
                           
        }
           
    };
	
	$(document).ready(function() {	
		$(document).keydown(function(tecla){ 
				var tec = tecla.keyCode ;
				webcamSocket.send(JSON.stringify({
            	'message': tec,
           		 'tipo': 'tecla',
           		 'accion':'oprimir'
       			 }));

		});
		
		$(document).keyup(function(tecla){ 
				var tec = tecla.keyCode ;
				webcamSocket.send(JSON.stringify({
            	'message': tec,
           		 'tipo': 'tecla',
           		 'accion':'soltar'
       			}));
		});
	});
	</script>
</head>
<body style="overflow-y: hidden;" class="body">
	<img src="" id='streaming' width="50%" class="imagen">
	<div class="divr"></div>
	<div class="div1">
		ESPACIO DISPONIBLE PARA LOS COMANDOS DE OPERACION ...
		PROXIMAMENTE ...
		
	</div>
	<div class="div2">
		ESPACIO PARA GENERAR MAPA BASADO EN LOS SENSORES ...
	</div>
	<div class="divl"></div>
</body>
</html>
